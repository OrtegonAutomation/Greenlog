Pantalla_Planeacion As screen:
    Fill: =RGBA(249, 250, 251, 1)
    OnVisible: |-
        =Set(gblSeccionActiva, "planeacion");
        Set(gblFiltroEstado, "Todos");
        Set(gblFiltroTipo, "Todos")

    # ── HEADER ──────────────────────────────────────────────────
    Rect_Header_Plan As rectangle:
        X: =0
        Y: =0
        Width: =Parent.Width
        Height: =72
        Fill: =RGBA(0, 34, 102, 1)
        BorderThickness: =0

    Lbl_Header_Plan As label:
        X: =20
        Y: =0
        Width: =Parent.Width - 100
        Height: =72
        Text: ="Planeación de Actividades"
        Color: =RGBA(255, 255, 255, 1)
        Size: =17
        FontWeight: =FontWeight.Bold
        VerticalAlign: =VerticalAlign.Middle

    Btn_Nueva_Plan As button:
        X: =Parent.Width - 90
        Y: =14
        Width: =80
        Height: =44
        Text: ="+ Nueva"
        Size: =12
        FontWeight: =FontWeight.Bold
        Fill: =RGBA(140, 198, 63, 1)
        Color: =RGBA(255, 255, 255, 1)
        HoverFill: =RGBA(122, 184, 47, 1)
        BorderThickness: =0
        RadiusTopLeft: =8
        RadiusTopRight: =8
        RadiusBottomLeft: =8
        RadiusBottomRight: =8
        OnSelect: =Navigate(Pantalla_Nueva, ScreenTransition.Cover)

    # ── BUSCADOR ────────────────────────────────────────────────
    Rect_Buscar_Plan_BG As rectangle:
        X: =10
        Y: =82
        Width: =Parent.Width - 20
        Height: =42
        Fill: =RGBA(255, 255, 255, 1)
        BorderColor: =RGBA(229, 231, 235, 1)
        BorderThickness: =1
        RadiusTopLeft: =8
        RadiusTopRight: =8
        RadiusBottomLeft: =8
        RadiusBottomRight: =8

    Ico_Buscar_Plan As icon:
        X: =20
        Y: =92
        Width: =22
        Height: =22
        Icon: =Icon.Search
        Color: =RGBA(75, 85, 99, 1)

    Txt_Buscar_Plan As text:
        X: =48
        Y: =82
        Width: =Parent.Width - 60
        Height: =42
        Default: =""
        HintText: ="Buscar por tarea o responsable..."
        BorderThickness: =0
        Fill: =RGBA(0, 0, 0, 0)
        Color: =RGBA(31, 41, 55, 1)
        Size: =13

    # ── FILTRO ESTADO ────────────────────────────────────────────
    Lbl_Filtro_Est As label:
        X: =14
        Y: =134
        Width: =60
        Height: =28
        Text: ="Estado:"
        Size: =12
        Color: =RGBA(75, 85, 99, 1)
        VerticalAlign: =VerticalAlign.Middle

    Btn_Filtro_Todos As button:
        X: =78
        Y: =134
        Width: =58
        Height: =28
        Text: ="Todos"
        Size: =11
        Fill: =If(gblFiltroEstado = "Todos", RGBA(0,51,160,1), RGBA(229,231,235,1))
        Color: =If(gblFiltroEstado = "Todos", RGBA(255,255,255,1), RGBA(75,85,99,1))
        BorderThickness: =0
        RadiusTopLeft: =14
        RadiusTopRight: =14
        RadiusBottomLeft: =14
        RadiusBottomRight: =14
        OnSelect: =Set(gblFiltroEstado, "Todos")

    Btn_Filtro_Planeada As button:
        X: =142
        Y: =134
        Width: =74
        Height: =28
        Text: ="Planeada"
        Size: =11
        Fill: =If(gblFiltroEstado = "Planeada", RGBA(0,51,160,1), RGBA(229,231,235,1))
        Color: =If(gblFiltroEstado = "Planeada", RGBA(255,255,255,1), RGBA(75,85,99,1))
        BorderThickness: =0
        RadiusTopLeft: =14
        RadiusTopRight: =14
        RadiusBottomLeft: =14
        RadiusBottomRight: =14
        OnSelect: =Set(gblFiltroEstado, "Planeada")

    Btn_Filtro_Ejec As button:
        X: =222
        Y: =134
        Width: =92
        Height: =28
        Text: ="En Ejecución"
        Size: =11
        Fill: =If(gblFiltroEstado = "En Ejecución", RGBA(245,158,11,1), RGBA(229,231,235,1))
        Color: =If(gblFiltroEstado = "En Ejecución", RGBA(255,255,255,1), RGBA(75,85,99,1))
        BorderThickness: =0
        RadiusTopLeft: =14
        RadiusTopRight: =14
        RadiusBottomLeft: =14
        RadiusBottomRight: =14
        OnSelect: =Set(gblFiltroEstado, "En Ejecución")

    Btn_Filtro_Cerr As button:
        X: =320
        Y: =134
        Width: =68
        Height: =28
        Text: ="Cerrada"
        Size: =11
        Fill: =If(gblFiltroEstado = "Cerrada", RGBA(140,198,63,1), RGBA(229,231,235,1))
        Color: =If(gblFiltroEstado = "Cerrada", RGBA(255,255,255,1), RGBA(75,85,99,1))
        BorderThickness: =0
        RadiusTopLeft: =14
        RadiusTopRight: =14
        RadiusBottomLeft: =14
        RadiusBottomRight: =14
        OnSelect: =Set(gblFiltroEstado, "Cerrada")

    # ── CONTADOR RESULTADOS ──────────────────────────────────────
    Lbl_Contador_Plan As label:
        X: =14
        Y: =172
        Width: =300
        Height: =20
        Text: =Text(CountRows(
            Filter(ActividadesAmbientales,
                (gblFiltroEstado = "Todos" || Estado = gblFiltroEstado) &&
                (IsBlank(Txt_Buscar_Plan.Text) ||
                    Title in Txt_Buscar_Plan.Text ||
                    Responsable in Txt_Buscar_Plan.Text)
            )
        )) & " actividad(es) encontradas"
        Size: =11
        Color: =RGBA(75, 85, 99, 1)

    # ── GALERÍA ──────────────────────────────────────────────────
    Gal_Actividades As gallery.flexible.height:
        X: =0
        Y: =196
        Width: =Parent.Width
        Height: =Parent.Height - 266
        Items: =Filter(ActividadesAmbientales,
            (gblFiltroEstado = "Todos" || Estado = gblFiltroEstado) &&
            (IsBlank(Txt_Buscar_Plan.Text) ||
                Title in Txt_Buscar_Plan.Text ||
                Responsable in Txt_Buscar_Plan.Text)
        )
        TemplatePadding: =6
        TemplateSize: =100
        ShowScrollbar: =false

        Rect_Act_BG As rectangle:
            X: =10
            Y: =4
            Width: =Parent.Width - 20
            Height: =92
            Fill: =RGBA(255, 255, 255, 1)
            BorderThickness: =0
            RadiusTopLeft: =12
            RadiusTopRight: =12
            RadiusBottomLeft: =12
            RadiusBottomRight: =12

        Rect_Act_Barra As rectangle:
            X: =10
            Y: =4
            Width: =5
            Height: =92
            Fill: =If(
                ThisItem.Estado = "Cerrada",                 RGBA(140, 198,  63, 1),
                If(ThisItem.Estado = "En Ejecución",         RGBA(245, 158,  11, 1),
                If(ThisItem.Estado = "Pendiente Aprobación", RGBA(139,  92, 246, 1),
                RGBA(0, 51, 160, 1)))
            )
            BorderThickness: =0
            RadiusTopLeft: =12
            RadiusBottomLeft: =12

        Lbl_Act_Tarea As label:
            X: =26
            Y: =12
            Width: =Parent.Width - 160
            Height: =24
            Text: =ThisItem.Title
            Size: =13
            FontWeight: =FontWeight.Bold
            Color: =RGBA(31, 41, 55, 1)
            Overflow: =Overflow.Hidden

        Lbl_Act_Estado As label:
            X: =Parent.Width - 140
            Y: =12
            Width: =130
            Height: =22
            Text: =ThisItem.Estado
            Size: =10
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =If(
                ThisItem.Estado = "Cerrada",                 RGBA(140, 198,  63, 1),
                If(ThisItem.Estado = "En Ejecución",         RGBA(245, 158,  11, 1),
                If(ThisItem.Estado = "Pendiente Aprobación", RGBA(139,  92, 246, 1),
                RGBA(0, 51, 160, 1)))
            )
            RadiusTopLeft: =11
            RadiusTopRight: =11
            RadiusBottomLeft: =11
            RadiusBottomRight: =11

        Lbl_Act_Tipo As label:
            X: =26
            Y: =38
            Width: =200
            Height: =18
            Text: =ThisItem.TipoActividad & " · " & ThisItem.Responsable
            Size: =11
            Color: =RGBA(75, 85, 99, 1)
            Overflow: =Overflow.Hidden

        Lbl_Act_Zona As label:
            X: =26
            Y: =58
            Width: =Parent.Width - 60
            Height: =18
            Text: =ThisItem.UbicacionZona
            Size: =11
            Color: =RGBA(75, 85, 99, 1)
            Overflow: =Overflow.Hidden

        Rect_Avance_BG As rectangle:
            X: =26
            Y: =78
            Width: =Parent.Width - 60
            Height: =8
            Fill: =RGBA(229, 231, 235, 1)
            BorderThickness: =0
            RadiusTopLeft: =4
            RadiusTopRight: =4
            RadiusBottomLeft: =4
            RadiusBottomRight: =4

        Rect_Avance_Bar As rectangle:
            X: =26
            Y: =78
            Width: =Max(0, (Parent.Width - 60) * ThisItem.PorcentajeAvance / 100)
            Height: =8
            Fill: =If(
                ThisItem.PorcentajeAvance >= 100, RGBA(140, 198, 63, 1),
                If(ThisItem.PorcentajeAvance >= 50,  RGBA(245, 158, 11, 1),
                RGBA(0, 51, 160, 1))
            )
            BorderThickness: =0
            RadiusTopLeft: =4
            RadiusTopRight: =4
            RadiusBottomLeft: =4
            RadiusBottomRight: =4

        Lbl_Act_Avance As label:
            X: =Parent.Width - 54
            Y: =74
            Width: =40
            Height: =18
            Text: =Text(ThisItem.PorcentajeAvance) & "%"
            Size: =10
            FontWeight: =FontWeight.Bold
            Align: =Align.Right
            Color: =RGBA(0, 51, 160, 1)

        Btn_Act_Abrir As button:
            X: =10
            Y: =4
            Width: =Parent.Width - 20
            Height: =92
            Text: =""
            Fill: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0.03)
            BorderThickness: =0
            RadiusTopLeft: =12
            RadiusTopRight: =12
            RadiusBottomLeft: =12
            RadiusBottomRight: =12
            OnSelect: |-
                =Set(gblActividadSeleccionada, ThisItem);
                Navigate(Pantalla_Detalle, ScreenTransition.Fade)

    # ── BOTTOM NAV ───────────────────────────────────────────────
    Rect_NavBG_Plan As rectangle:
        X: =0
        Y: =Parent.Height - 70
        Width: =Parent.Width
        Height: =70
        Fill: =RGBA(255, 255, 255, 1)
        BorderColor: =RGBA(229, 231, 235, 1)
        BorderThickness: =1

    Btn_Nav2_Dash As button:
        X: =0
        Y: =Parent.Height - 70
        Width: =Parent.Width / 4
        Height: =70
        Text: ="Dashboard"
        Size: =10
        Fill: =RGBA(255, 255, 255, 1)
        Color: =RGBA(75, 85, 99, 1)
        HoverFill: =RGBA(249, 250, 251, 1)
        BorderThickness: =0
        OnSelect: =Navigate(Pantalla_Dashboard, ScreenTransition.None)

    Btn_Nav2_Plan As button:
        X: =Parent.Width / 4
        Y: =Parent.Height - 70
        Width: =Parent.Width / 4
        Height: =70
        Text: ="Planeación"
        Size: =10
        FontWeight: =FontWeight.Bold
        Fill: =RGBA(240, 244, 255, 1)
        Color: =RGBA(0, 51, 160, 1)
        HoverFill: =RGBA(230, 237, 255, 1)
        BorderThickness: =0
        OnSelect: =Navigate(Pantalla_Planeacion, ScreenTransition.None)

    Btn_Nav2_Ejec As button:
        X: =Parent.Width / 2
        Y: =Parent.Height - 70
        Width: =Parent.Width / 4
        Height: =70
        Text: ="Ejecución"
        Size: =10
        Fill: =RGBA(255, 255, 255, 1)
        Color: =RGBA(75, 85, 99, 1)
        HoverFill: =RGBA(249, 250, 251, 1)
        BorderThickness: =0
        OnSelect: =Navigate(Pantalla_Ejecucion, ScreenTransition.None)

    Btn_Nav2_Rep As button:
        X: =3 * Parent.Width / 4
        Y: =Parent.Height - 70
        Width: =Parent.Width / 4
        Height: =70
        Text: ="Reportes"
        Size: =10
        Fill: =RGBA(255, 255, 255, 1)
        Color: =RGBA(75, 85, 99, 1)
        HoverFill: =RGBA(249, 250, 251, 1)
        BorderThickness: =0
        OnSelect: =Navigate(Pantalla_Reportes, ScreenTransition.None)
