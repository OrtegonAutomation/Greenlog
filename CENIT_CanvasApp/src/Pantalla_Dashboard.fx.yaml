Pantalla_Dashboard As screen:
    Fill: =RGBA(249, 250, 251, 1)
    OnVisible: =Set(gblSeccionActiva, "dashboard")

    # ── HEADER ──────────────────────────────────────────────────
    Rect_Header_Dash As rectangle:
        X: =0
        Y: =0
        Width: =Parent.Width
        Height: =90
        Fill: =RGBA(0, 34, 102, 1)
        BorderThickness: =0

    Lbl_App_Nombre As label:
        X: =20
        Y: =8
        Width: =Parent.Width - 40
        Height: =28
        Text: ="CENIT"
        Color: =RGBA(140, 198, 63, 1)
        Size: =20
        FontWeight: =FontWeight.Bold

    Lbl_App_Sub As label:
        X: =20
        Y: =36
        Width: =Parent.Width - 40
        Height: =22
        Text: ="Sistema de Control Ambiental · GREENLOG"
        Color: =RGBA(165, 180, 210, 1)
        Size: =12

    Lbl_Fecha_Hoy As label:
        X: =20
        Y: =60
        Width: =Parent.Width - 40
        Height: =22
        Text: =Text(Today(), "[$-es-CO]dddd, d 'de' mmmm yyyy")
        Color: =RGBA(200, 210, 230, 1)
        Size: =11

    # ── KPI CARDS ───────────────────────────────────────────────
    Lbl_Seccion_KPI As label:
        X: =20
        Y: =102
        Width: =300
        Height: =24
        Text: ="Resumen general"
        Size: =14
        FontWeight: =FontWeight.Bold
        Color: =RGBA(31, 41, 55, 1)

    # KPI 1: Total actividades
    Rect_KPI_Total As rectangle:
        X: =10
        Y: =130
        Width: =(Parent.Width - 30) / 2
        Height: =80
        Fill: =RGBA(255, 255, 255, 1)
        BorderThickness: =0
        RadiusTopLeft: =12
        RadiusTopRight: =12
        RadiusBottomLeft: =12
        RadiusBottomRight: =12

    Lbl_KPI_Total_Num As label:
        X: =10
        Y: =138
        Width: =(Parent.Width - 30) / 2
        Height: =36
        Text: =Text(CountRows(ActividadesAmbientales))
        Size: =28
        FontWeight: =FontWeight.Bold
        Align: =Align.Center
        Color: =RGBA(0, 51, 160, 1)

    Lbl_KPI_Total_Lbl As label:
        X: =10
        Y: =176
        Width: =(Parent.Width - 30) / 2
        Height: =28
        Text: ="Total Actividades"
        Size: =12
        Align: =Align.Center
        Color: =RGBA(75, 85, 99, 1)

    # KPI 2: En Ejecución
    Rect_KPI_Ejec As rectangle:
        X: =20 + (Parent.Width - 30) / 2
        Y: =130
        Width: =(Parent.Width - 30) / 2
        Height: =80
        Fill: =RGBA(255, 255, 255, 1)
        BorderThickness: =0
        RadiusTopLeft: =12
        RadiusTopRight: =12
        RadiusBottomLeft: =12
        RadiusBottomRight: =12

    Lbl_KPI_Ejec_Num As label:
        X: =20 + (Parent.Width - 30) / 2
        Y: =138
        Width: =(Parent.Width - 30) / 2
        Height: =36
        Text: =Text(CountRows(Filter(ActividadesAmbientales, Estado = "En Ejecución")))
        Size: =28
        FontWeight: =FontWeight.Bold
        Align: =Align.Center
        Color: =RGBA(245, 158, 11, 1)

    Lbl_KPI_Ejec_Lbl As label:
        X: =20 + (Parent.Width - 30) / 2
        Y: =176
        Width: =(Parent.Width - 30) / 2
        Height: =28
        Text: ="En Ejecución"
        Size: =12
        Align: =Align.Center
        Color: =RGBA(75, 85, 99, 1)

    # KPI 3: Cerradas / Completadas
    Rect_KPI_Cerradas As rectangle:
        X: =10
        Y: =220
        Width: =(Parent.Width - 30) / 2
        Height: =80
        Fill: =RGBA(255, 255, 255, 1)
        BorderThickness: =0
        RadiusTopLeft: =12
        RadiusTopRight: =12
        RadiusBottomLeft: =12
        RadiusBottomRight: =12

    Lbl_KPI_Cerradas_Num As label:
        X: =10
        Y: =228
        Width: =(Parent.Width - 30) / 2
        Height: =36
        Text: =Text(CountRows(Filter(ActividadesAmbientales, Estado = "Cerrada")))
        Size: =28
        FontWeight: =FontWeight.Bold
        Align: =Align.Center
        Color: =RGBA(140, 198, 63, 1)

    Lbl_KPI_Cerradas_Lbl As label:
        X: =10
        Y: =266
        Width: =(Parent.Width - 30) / 2
        Height: =28
        Text: ="Cerradas"
        Size: =12
        Align: =Align.Center
        Color: =RGBA(75, 85, 99, 1)

    # KPI 4: Pendiente Aprobación
    Rect_KPI_PendApro As rectangle:
        X: =20 + (Parent.Width - 30) / 2
        Y: =220
        Width: =(Parent.Width - 30) / 2
        Height: =80
        Fill: =RGBA(255, 255, 255, 1)
        BorderThickness: =0
        RadiusTopLeft: =12
        RadiusTopRight: =12
        RadiusBottomLeft: =12
        RadiusBottomRight: =12

    Lbl_KPI_PendApro_Num As label:
        X: =20 + (Parent.Width - 30) / 2
        Y: =228
        Width: =(Parent.Width - 30) / 2
        Height: =36
        Text: =Text(CountRows(Filter(ActividadesAmbientales, Estado = "Pendiente Aprobación")))
        Size: =28
        FontWeight: =FontWeight.Bold
        Align: =Align.Center
        Color: =RGBA(139, 92, 246, 1)

    Lbl_KPI_PendApro_Lbl As label:
        X: =20 + (Parent.Width - 30) / 2
        Y: =266
        Width: =(Parent.Width - 30) / 2
        Height: =28
        Text: ="Pend. Aprobación"
        Size: =12
        Align: =Align.Center
        Color: =RGBA(75, 85, 99, 1)

    # ── AVANCE PROMEDIO ─────────────────────────────────────────
    Rect_KPI_Avance As rectangle:
        X: =10
        Y: =312
        Width: =Parent.Width - 20
        Height: =70
        Fill: =RGBA(0, 51, 160, 1)
        BorderThickness: =0
        RadiusTopLeft: =12
        RadiusTopRight: =12
        RadiusBottomLeft: =12
        RadiusBottomRight: =12

    Lbl_Avance_Tit As label:
        X: =26
        Y: =320
        Width: =260
        Height: =24
        Text: ="Avance promedio del programa"
        Size: =13
        Color: =RGBA(200, 215, 240, 1)
        FontWeight: =FontWeight.Semibold

    Lbl_Avance_Pct As label:
        X: =Parent.Width - 130
        Y: =318
        Width: =116
        Height: =54
        Text: =Text(
            If(CountRows(ActividadesAmbientales) > 0,
                Round(Sum(ActividadesAmbientales, PorcentajeAvance) / CountRows(ActividadesAmbientales), 0),
                0
            )
        ) & "%"
        Size: =30
        FontWeight: =FontWeight.Bold
        Color: =RGBA(140, 198, 63, 1)
        Align: =Align.Right
        VerticalAlign: =VerticalAlign.Middle

    # ── ACTIVIDADES RECIENTES ────────────────────────────────────
    Lbl_Seccion_Recientes As label:
        X: =20
        Y: =398
        Width: =300
        Height: =24
        Text: ="Actividades recientes"
        Size: =14
        FontWeight: =FontWeight.Bold
        Color: =RGBA(31, 41, 55, 1)

    Gal_Recientes As gallery.flexible.height:
        X: =0
        Y: =426
        Width: =Parent.Width
        Height: =Parent.Height - 496
        Items: =FirstN(
            SortByColumns(ActividadesAmbientales, "Modified", SortOrder.Descending),
            5
        )
        TemplatePadding: =6
        TemplateSize: =76
        ShowScrollbar: =false

        Rect_Rec_BG As rectangle:
            X: =10
            Y: =4
            Width: =Parent.Width - 20
            Height: =68
            Fill: =RGBA(255, 255, 255, 1)
            BorderThickness: =0
            RadiusTopLeft: =10
            RadiusTopRight: =10
            RadiusBottomLeft: =10
            RadiusBottomRight: =10

        Rect_Rec_Barra As rectangle:
            X: =10
            Y: =4
            Width: =5
            Height: =68
            Fill: =If(
                ThisItem.Estado = "Cerrada",            RGBA(140, 198,  63, 1),
                If(ThisItem.Estado = "En Ejecución",    RGBA(245, 158,  11, 1),
                If(ThisItem.Estado = "Pendiente Aprobación", RGBA(139, 92, 246, 1),
                RGBA(0, 51, 160, 1)))
            )
            BorderThickness: =0
            RadiusTopLeft: =10
            RadiusBottomLeft: =10

        Lbl_Rec_Tarea As label:
            X: =26
            Y: =10
            Width: =Parent.Width - 130
            Height: =24
            Text: =ThisItem.Title
            Size: =13
            FontWeight: =FontWeight.Semibold
            Color: =RGBA(31, 41, 55, 1)
            Overflow: =Overflow.Hidden

        Lbl_Rec_Estado As label:
            X: =Parent.Width - 120
            Y: =10
            Width: =110
            Height: =22
            Text: =ThisItem.Estado
            Size: =10
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =If(
                ThisItem.Estado = "Cerrada",                 RGBA(140, 198,  63, 1),
                If(ThisItem.Estado = "En Ejecución",         RGBA(245, 158,  11, 1),
                If(ThisItem.Estado = "Pendiente Aprobación", RGBA(139,  92, 246, 1),
                RGBA(0, 51, 160, 1)))
            )
            RadiusTopLeft: =11
            RadiusTopRight: =11
            RadiusBottomLeft: =11
            RadiusBottomRight: =11

        Lbl_Rec_Tipo As label:
            X: =26
            Y: =36
            Width: =160
            Height: =20
            Text: =ThisItem.TipoActividad & " · " & ThisItem.UbicacionZona
            Size: =11
            Color: =RGBA(75, 85, 99, 1)
            Overflow: =Overflow.Hidden

        Lbl_Rec_Avance As label:
            X: =26
            Y: =54
            Width: =100
            Height: =16
            Text: =Text(ThisItem.PorcentajeAvance) & "% avance"
            Size: =10
            Color: =RGBA(0, 51, 160, 1)
            FontWeight: =FontWeight.Semibold

        Btn_Rec_Abrir As button:
            X: =10
            Y: =4
            Width: =Parent.Width - 20
            Height: =68
            Text: =""
            Fill: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0.03)
            BorderThickness: =0
            RadiusTopLeft: =10
            RadiusTopRight: =10
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            OnSelect: |-
                =Set(gblActividadSeleccionada, ThisItem);
                Navigate(Pantalla_Detalle, ScreenTransition.Fade)

    # ── BOTTOM NAV ───────────────────────────────────────────────
    Rect_NavBG As rectangle:
        X: =0
        Y: =Parent.Height - 70
        Width: =Parent.Width
        Height: =70
        Fill: =RGBA(255, 255, 255, 1)
        BorderColor: =RGBA(229, 231, 235, 1)
        BorderThickness: =1

    Btn_Nav_Dash As button:
        X: =0
        Y: =Parent.Height - 70
        Width: =Parent.Width / 4
        Height: =70
        Text: ="Dashboard"
        Size: =10
        FontWeight: =FontWeight.Bold
        Fill: =RGBA(240, 244, 255, 1)
        Color: =RGBA(0, 51, 160, 1)
        HoverFill: =RGBA(230, 237, 255, 1)
        BorderThickness: =0
        OnSelect: =Navigate(Pantalla_Dashboard, ScreenTransition.None)

    Btn_Nav_Plan As button:
        X: =Parent.Width / 4
        Y: =Parent.Height - 70
        Width: =Parent.Width / 4
        Height: =70
        Text: ="Planeación"
        Size: =10
        Fill: =RGBA(255, 255, 255, 1)
        Color: =RGBA(75, 85, 99, 1)
        HoverFill: =RGBA(249, 250, 251, 1)
        BorderThickness: =0
        OnSelect: =Navigate(Pantalla_Planeacion, ScreenTransition.None)

    Btn_Nav_Ejec As button:
        X: =Parent.Width / 2
        Y: =Parent.Height - 70
        Width: =Parent.Width / 4
        Height: =70
        Text: ="Ejecución"
        Size: =10
        Fill: =RGBA(255, 255, 255, 1)
        Color: =RGBA(75, 85, 99, 1)
        HoverFill: =RGBA(249, 250, 251, 1)
        BorderThickness: =0
        OnSelect: =Navigate(Pantalla_Ejecucion, ScreenTransition.None)

    Btn_Nav_Rep As button:
        X: =3 * Parent.Width / 4
        Y: =Parent.Height - 70
        Width: =Parent.Width / 4
        Height: =70
        Text: ="Reportes"
        Size: =10
        Fill: =RGBA(255, 255, 255, 1)
        Color: =RGBA(75, 85, 99, 1)
        HoverFill: =RGBA(249, 250, 251, 1)
        BorderThickness: =0
        OnSelect: =Navigate(Pantalla_Reportes, ScreenTransition.None)
